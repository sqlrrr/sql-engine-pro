<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL ENGINE PRO - Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #0a0a0a; color: #fff; }
        .container { display: flex; height: 100vh; }
        .sidebar { width: 200px; background: #1a1a1a; border-right: 2px solid #ffd700; padding: 20px; overflow-y: auto; }
        .sidebar h2 { color: #ffd700; margin-bottom: 20px; font-size: 18px; }
        .nav-item { padding: 12px; margin: 8px 0; background: #2a2a2a; border-left: 3px solid #ffd700; cursor: pointer; border-radius: 4px; }
        .nav-item:hover { background: #3a3a3a; }
        .nav-item.active { background: #ffd700; color: #000; }
        .main { flex: 1; display: flex; flex-direction: column; }
        .header { background: #1a1a1a; border-bottom: 2px solid #ffd700; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { color: #ffd700; }
        .logout-btn { background: #ff4444; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        .content { flex: 1; overflow-y: auto; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .card { background: #1a1a1a; border: 2px solid #ffd700; padding: 20px; border-radius: 8px; }
        .card h3 { color: #ffd700; margin-bottom: 10px; }
        .card-value { font-size: 28px; font-weight: bold; margin: 10px 0; }
        .card-change { font-size: 12px; color: #999; margin-top: 5px; }
        .loading { color: #ffd700; text-align: center; padding: 20px; }
        .error { color: #ff4444; }
        .positive { color: #4ade80; }
        .negative { color: #ff4444; }
        .status-badge { display: inline-block; padding: 5px 10px; border-radius: 3px; font-size: 12px; margin-top: 5px; }
        .status-online { background: #4ade80; color: #000; }
        .status-offline { background: #ff4444; color: #fff; }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h2>üöÄ SQL ENGINE</h2>
            <div class="nav-item active">üìä Dashboard</div>
            <div class="nav-item">‚ö° Signals</div>
            <div class="nav-item">üêã Whales</div>
            <div class="nav-item">üí¨ Sentiment</div>
            <div class="nav-item">‚õìÔ∏è On-Chain</div>
            <div class="nav-item">üî• Solana</div>
            <div style="margin-top: 30px; padding: 10px; background: #2a2a2a; border-radius: 4px; font-size: 12px;">
                <div>Backend Status:</div>
                <div id="backend-status" class="status-badge status-offline">Checking...</div>
            </div>
        </div>
        <div class="main">
            <div class="header">
                <h1>üìä SQL ENGINE PRO - Live Dashboard</h1>
                <button class="logout-btn">Logout</button>
            </div>
            <div class="content">
                <h2 style="color: #ffd700; margin-bottom: 20px;">üí∞ Live Crypto Prices (Real Data)</h2>
                <div class="grid">
                    <div class="card">
                        <h3>Bitcoin (BTC)</h3>
                        <div class="card-value" id="btc-price">Loading...</div>
                        <div class="card-change" id="btc-change">-</div>
                    </div>
                    <div class="card">
                        <h3>Ethereum (ETH)</h3>
                        <div class="card-value" id="eth-price">Loading...</div>
                        <div class="card-change" id="eth-change">-</div>
                    </div>
                    <div class="card">
                        <h3>Solana (SOL)</h3>
                        <div class="card-value" id="sol-price">Loading...</div>
                        <div class="card-change" id="sol-change">-</div>
                    </div>
                </div>

                <h2 style="color: #ffd700; margin: 30px 0 20px 0;">‚ö° AI Trading Signals (Real Data)</h2>
                <div class="grid">
                    <div class="card">
                        <h3 id="signal-btc-symbol">BTC Signal</h3>
                        <div class="card-value" id="signal-btc-action">Loading...</div>
                        <div class="card-change" id="signal-btc-score">-</div>
                    </div>
                    <div class="card">
                        <h3 id="signal-eth-symbol">ETH Signal</h3>
                        <div class="card-value" id="signal-eth-action">Loading...</div>
                        <div class="card-change" id="signal-eth-score">-</div>
                    </div>
                    <div class="card">
                        <h3 id="signal-sol-symbol">SOL Signal</h3>
                        <div class="card-value" id="signal-sol-action">Loading...</div>
                        <div class="card-change" id="signal-sol-score">-</div>
                    </div>
                </div>

                <h2 style="color: #ffd700; margin: 30px 0 20px 0;">üêã Whale Movements</h2>
                <div class="card">
                    <div id="whales-container" class="loading">Loading whale data...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Backend API URL - Change this to your deployed backend
        const API_BASE = 'http://localhost:3000/api';
        
        // Alternative: If backend is deployed, use:
        // const API_BASE = 'https://your-backend-url.com/api';

        async function checkBackendStatus() {
            try {
                const response = await fetch(API_BASE + '/health', { timeout: 5000 });
                if (response.ok) {
                    document.getElementById('backend-status').textContent = '‚úì Online';
                    document.getElementById('backend-status').className = 'status-badge status-online';
                    return true;
                }
            } catch (e) {
                console.error('Backend offline:', e);
            }
            document.getElementById('backend-status').textContent = '‚úó Offline';
            document.getElementById('backend-status').className = 'status-badge status-offline';
            return false;
        }

        async function getPrices() {
            try {
                const response = await fetch(API_BASE + '/prices?symbols=bitcoin,ethereum,solana');
                const data = await response.json();
                
                if (data.success && data.data) {
                    data.data.forEach(p => {
                        const change = p.change24h || 0;
                        const changeColor = change > 0 ? 'positive' : 'negative';
                        const changeText = (change > 0 ? '‚Üë' : '‚Üì') + ' ' + Math.abs(change).toFixed(2) + '%';
                        
                        if (p.symbol === 'BITCOIN') {
                            document.getElementById('btc-price').textContent = '$' + p.price.toLocaleString('en-US', {maximumFractionDigits: 0});
                            document.getElementById('btc-change').textContent = changeText;
                            document.getElementById('btc-change').className = 'card-change ' + changeColor;
                        } else if (p.symbol === 'ETHEREUM') {
                            document.getElementById('eth-price').textContent = '$' + p.price.toLocaleString('en-US', {maximumFractionDigits: 0});
                            document.getElementById('eth-change').textContent = changeText;
                            document.getElementById('eth-change').className = 'card-change ' + changeColor;
                        } else if (p.symbol === 'SOLANA') {
                            document.getElementById('sol-price').textContent = '$' + p.price.toLocaleString('en-US', {maximumFractionDigits: 2});
                            document.getElementById('sol-change').textContent = changeText;
                            document.getElementById('sol-change').className = 'card-change ' + changeColor;
                        }
                    });
                }
            } catch (error) {
                console.error('Error fetching prices:', error);
                document.getElementById('btc-price').textContent = 'Error';
                document.getElementById('eth-price').textContent = 'Error';
                document.getElementById('sol-price').textContent = 'Error';
            }
        }

        async function getSignals() {
            try {
                const symbols = ['BTC', 'ETH', 'SOL'];
                
                for (const symbol of symbols) {
                    const response = await fetch(API_BASE + '/signals?symbol=' + symbol);
                    const data = await response.json();
                    
                    if (data.success && data.data) {
                        const action = data.data.action;
                        const score = data.data.score;
                        const color = action === 'BUY' ? '#4ade80' : action === 'SELL' ? '#ff4444' : '#ffd700';
                        
                        const lowerSymbol = symbol.toLowerCase();
                        document.getElementById(`signal-${lowerSymbol}-action`).textContent = action;
                        document.getElementById(`signal-${lowerSymbol}-action`).style.color = color;
                        document.getElementById(`signal-${lowerSymbol}-score`).textContent = `Score: ${score} | Confidence: ${data.data.confidence}`;
                    }
                }
            } catch (error) {
                console.error('Error fetching signals:', error);
            }
        }

        async function getWhales() {
            try {
                const response = await fetch(API_BASE + '/whales');
                const data = await response.json();
                
                if (data.success && data.data) {
                    let html = '<table style="width: 100%; border-collapse: collapse;">';
                    html += '<tr style="border-bottom: 1px solid #ffd700;"><th style="text-align: left; padding: 10px; color: #ffd700;">Amount</th><th style="text-align: left; padding: 10px; color: #ffd700;">From</th><th style="text-align: left; padding: 10px; color: #ffd700;">To</th><th style="text-align: left; padding: 10px; color: #ffd700;">Type</th><th style="text-align: left; padding: 10px; color: #ffd700;">Value</th></tr>';
                    
                    data.data.forEach(whale => {
                        const typeColor = whale.type === 'OUTFLOW' ? '#4ade80' : '#ff4444';
                        const value = '$' + (whale.usdValue / 1000000).toFixed(1) + 'M';
                        html += `<tr style="border-bottom: 1px solid #333;"><td style="padding: 10px;">${whale.amount} ${whale.token}</td><td style="padding: 10px;">${whale.from}</td><td style="padding: 10px;">${whale.to}</td><td style="padding: 10px; color: ${typeColor};">${whale.type}</td><td style="padding: 10px;">${value}</td></tr>`;
                    });
                    
                    html += '</table>';
                    document.getElementById('whales-container').innerHTML = html;
                }
            } catch (error) {
                console.error('Error fetching whales:', error);
                document.getElementById('whales-container').innerHTML = '<div class="error">Failed to load whale data</div>';
            }
        }

        async function init() {
            await checkBackendStatus();
            await getPrices();
            await getSignals();
            await getWhales();
            
            // Refresh every 30 seconds
            setInterval(async () => {
                await checkBackendStatus();
                await getPrices();
                await getSignals();
            }, 30000);
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
