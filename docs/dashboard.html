<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL ENGINE PRO - Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #0a0a0a; color: #fff; }
        .container { display: flex; height: 100vh; }
        .sidebar { width: 200px; background: #1a1a1a; border-right: 2px solid #ffd700; padding: 20px; overflow-y: auto; }
        .sidebar h2 { color: #ffd700; margin-bottom: 20px; font-size: 18px; }
        .nav-item { padding: 12px; margin: 8px 0; background: #2a2a2a; border-left: 3px solid #ffd700; cursor: pointer; border-radius: 4px; }
        .nav-item:hover { background: #3a3a3a; }
        .nav-item.active { background: #ffd700; color: #000; }
        .main { flex: 1; display: flex; flex-direction: column; }
        .header { background: #1a1a1a; border-bottom: 2px solid #ffd700; padding: 20px; display: flex; justify-content: space-between; }
        .header h1 { color: #ffd700; }
        .logout-btn { background: #ff4444; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        .content { flex: 1; overflow-y: auto; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .card { background: #1a1a1a; border: 2px solid #ffd700; padding: 20px; border-radius: 8px; }
        .card h3 { color: #ffd700; margin-bottom: 10px; }
        .card-value { font-size: 28px; font-weight: bold; margin: 10px 0; }
        .loading { color: #ffd700; text-align: center; }
        .error { color: #ff4444; background: #2a1a1a; padding: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h2>üöÄ SQL ENGINE</h2>
            <div class="nav-item active">üìä Dashboard</div>
            <div class="nav-item">‚ö° Signals</div>
            <div class="nav-item">üêã Whales</div>
            <div class="nav-item">üí¨ Sentiment</div>
            <div class="nav-item">‚õìÔ∏è On-Chain</div>
            <div class="nav-item">üî• Solana</div>
            <div class="nav-item">üìà Trading</div>
            <div class="nav-item">‚öôÔ∏è Settings</div>
        </div>
        <div class="main">
            <div class="header">
                <h1>üìä SQL ENGINE PRO - Dashboard</h1>
                <button class="logout-btn">Logout</button>
            </div>
            <div class="content">
                <div class="grid">
                    <div class="card">
                        <h3>Portfolio Value</h3>
                        <div class="card-value" id="portfolio">$0</div>
                        <div id="portfolioChange" style="font-size: 12px; color: #999;">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>Active Positions</h3>
                        <div class="card-value" id="positions">0</div>
                        <div id="positionBreakdown" style="font-size: 12px; color: #999;">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>Win Rate</h3>
                        <div class="card-value" id="winRate">0%</div>
                        <div style="font-size: 12px; color: #999;">Weekly change</div>
                    </div>
                    <div class="card">
                        <h3>Total P&L</h3>
                        <div class="card-value" id="pnl">+$0</div>
                        <div style="font-size: 12px; color: #999;">Target: $50K</div>
                    </div>
                </div>
                <div class="grid">
                    <div class="card">
                        <h3>Bitcoin (BTC)</h3>
                        <div class="card-value" id="btc">$0</div>
                        <div id="btcChange" style="font-size: 12px; color: #999;">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>Ethereum (ETH)</h3>
                        <div class="card-value" id="eth">$0</div>
                        <div id="ethChange" style="font-size: 12px; color: #999;">Loading...</div>
                    </div>
                    <div class="card">
                        <h3>Solana (SOL)</h3>
                        <div class="card-value" id="sol">$0</div>
                        <div id="solChange" style="font-size: 12px; color: #999;">Loading...</div>
                    </div>
                </div>
                <div class="card">
                    <h3>‚ö° AI Trading Signals</h3>
                    <div id="signals" class="loading">Loading signals...</div>
                </div>
                <div class="card">
                    <h3>üêã Whale Tracking</h3>
                    <div id="whales" class="loading">Loading whales...</div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const API_BASE = 'http://localhost:3000/api';
        
        async function fetch_data(endpoint) {
            try {
                const res = await fetch(API_BASE + endpoint);
                return res.ok ? await res.json() : null;
            } catch (e) {
                console.error(e);
                return null;
            }
        }
        
        async function load_dashboard() {
            const data = await fetch_data('/dashboard');
            if (data && data.success) {
                const p = data.data.portfolio;
                document.getElementById('portfolio').textContent = '$' + p.value.toLocaleString();
                document.getElementById('portfolioChange').textContent = '‚Üë +$' + p.change24h.toLocaleString() + ' (' + p.changePercent + '%)';
                document.getElementById('positions').textContent = p.positions;
                document.getElementById('positionBreakdown').textContent = p.buyCount + ' BUY | ' + p.sellCount + ' SELL | ' + p.holdCount + ' HOLD';
                document.getElementById('winRate').textContent = p.winRate + '%';
                document.getElementById('pnl').textContent = '+$' + p.totalPnL.toLocaleString();
            }
        }
        
        async function load_prices() {
            const data = await fetch_data('/prices?symbols=bitcoin,ethereum,solana');
            if (data && data.success) {
                data.data.forEach(p => {
                    if (p.symbol === 'BITCOIN') {
                        document.getElementById('btc').textContent = '$' + p.price.toLocaleString();
                        document.getElementById('btcChange').textContent = (p.change24h > 0 ? '‚Üë' : '‚Üì') + ' ' + Math.abs(p.change24h).toFixed(2) + '%';
                    } else if (p.symbol === 'ETHEREUM') {
                        document.getElementById('eth').textContent = '$' + p.price.toLocaleString();
                        document.getElementById('ethChange').textContent = (p.change24h > 0 ? '‚Üë' : '‚Üì') + ' ' + Math.abs(p.change24h).toFixed(2) + '%';
                    } else if (p.symbol === 'SOLANA') {
                        document.getElementById('sol').textContent = '$' + p.price.toLocaleString();
                        document.getElementById('solChange').textContent = (p.change24h > 0 ? '‚Üë' : '‚Üì') + ' ' + Math.abs(p.change24h).toFixed(2) + '%';
                    }
                });
            }
        }
        
        async function load_signals() {
            const data = await fetch_data('/signals/all');
            if (data && data.success) {
                let html = '';
                data.data.slice(0, 5).forEach(s => {
                    html += '<div style="padding: 10px; margin: 5px 0; background: #2a2a2a; border-radius: 4px;"><strong>' + s.symbol + '</strong> - ' + s.action + ' (Score: ' + s.score + ')</div>';
                });
                document.getElementById('signals').innerHTML = html;
            }
        }
        
        async function load_whales() {
            const data = await fetch_data('/whales');
            if (data && data.success) {
                let html = '';
                data.data.slice(0, 3).forEach(w => {
                    html += '<div style="padding: 10px; margin: 5px 0; background: #2a2a2a; border-radius: 4px;"><strong>' + w.amount + ' ' + w.token + '</strong> ($' + (w.usdValue / 1000000).toFixed(1) + 'M) - ' + w.type + '</div>';
                });
                document.getElementById('whales').innerHTML = html;
            }
        }
        
        async function init() {
            await load_dashboard();
            await load_prices();
            await load_signals();
            await load_whales();
            setInterval(() => {
                load_dashboard();
                load_prices();
                load_signals();
                load_whales();
            }, 30000);
        }
        
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
